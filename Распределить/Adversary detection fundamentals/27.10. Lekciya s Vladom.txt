27.10. Lekciya s Vladom

Аудит - для того, чтобы детектить атаки.
Base audit bat - настройка событий, это что нужно иметь настроенным 

Сохранить file.bash
:: Audit Policy Change   - Что настраивает
:: 4719, 4912   - Ivent ID 
auditpol /set /subcategory:"Audit Policy Change" /success:enable /failure:enable

Group Pollicy - это штуки, на которые приходит админ логиниться и (hierarchical infrastructure that allows a network administrator in charge of Microsoft's Active Directory to implement specific configurations for users and computers.)

это набор правил или настроек, в соответствии с которыми производится настройка рабочей среды приёма/передачи


Ps audit - это включение аудита для Powershell
****reg.exe ADD HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Powershell\ScriptBlockLogging /v EnableScriptBlockLogging /t REG_DWORD /d 1***

Powershell - огромная штука )))

Event Viewer - для просмотра событий

The event ID 4104 

Reg inf

Microsoft Defender – Indicator of Compromise IOC - оповещалка об не санкционированных запусках по 


pid 1388 - malware
Eid 3 

https://learn.microsoft.com/ru-ru/sysinternals/downloads/sysmon
https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?source=Sysmon&eventID=7
https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventid=90008
https://www.vx-underground.org/
сикорски вскрытие покажет - книга посвещена анализу вредоносов 
https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventid=90011

https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventid=90013
sysmon id 13 
мы можем ловить, то что взлоумышленник хочет скачать

https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventid=90017
Pipe - способ общение между процессами
условно говоря 1 проц и 2 проц, и хотим чтобы они общались - это канал по которым можно передавать данные. 
Между двумя дисками есть место, и говорим что 1 и 2 процесс могут использовать это место


SMB - Server Message Block ( протокол для удаленного доступа к файлам )
Есть 3 версии SMB
SMB1 - не круто, а остальные норм)))

CobaltStrike - это маячок, с помощье которого глав общается с пк, где установлен этот кобольт 


Windows Management Instrumentation (WMI) в дословном переводе — инструментарий управления Windows
WMI может использоваться: для сбора информации о статусе локальных и удаленных компьютерных систем настройки параметров безопасности для удаленных компьютеров и приложений настройки и редактирования свойств системы

https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventid=90021
sysmon id 21

https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventid=90022
sysmon id 22 DNSEvent


https://attack.mitre.org/techniques/T1055/012/
Process Injection: Process Hollowing


Если svchost не от system //alert















DLL inject - инжект прикотором заставляем другой процесс подгрузить эту DLL, чтобы она запустилась.

