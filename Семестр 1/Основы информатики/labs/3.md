# Задание 1

Код `trace.scm`:
```scheme
(define-syntax trace-ex
  (syntax-rules ()
    ((trace-ex expr)
     (begin
       (write 'expr)
       (let ((res expr))
         (begin
           (display " => ")
           (write res)
           (newline)))))))     
```

Код `1.rkt`:
```scheme
(load "trace.scm")

(define (zip . xss)
  (if (or (null? xss)
          (null? (trace-ex (car xss))))
      '()
      (cons (map car xss)
            (apply zip (map cdr (trace-ex xss))))))

(zip '(1 2 3) '(one two three))
```
# Задание 2

```scheme

(define-syntax test
  (syntax-rules ()
    ((test expr res)
     (list expr res 'expr))))

(define (run-test test)
  (let ((expr (car test))
        (res_exp (cadr test))
        (expr_literal (caddr test)))
    (begin
      (write expr_literal)
      (let* ((res_got expr)
             (is_passed (equal? res_exp res_got)))
        (begin (if is_passed
                   (display " ok\n")
                   (begin (display " FAIL\n")
                          (display "  Expected: ")
                          (write res_exp)
                          (display "\n  Returned: ")
                          (write res_got)
                          (newline)))
               is_passed)))))

(define (run-tests tests)
  (let loop ((res #t)
             (cnter 1)
             (tests tests))
    
    (if (null? tests)
        res
        (begin (display "Test ")
               (display cnter)
               (display ": ")
               (loop (and (run-test (car tests)) res)
                     (+ 1 cnter)
                     (cdr tests))))))

(define (signum x)
  (cond
    ((< x 0) -1)
    ((= x 0)  1) ; Ошибка здесь!
    (else     1)))

(define the-tests
  (list (test (signum -2) -1)
        (test (signum  0)  0)
        (test (signum  2)  1)))

(run-tests the-tests)
```

# Задание 4

```scheme
(define (factorize polynom)
  (let ((is_plus (equal? '+ (car polynom)))
        (is_power2 (= 2 (car (reverse (cadr polynom)))))
        (a (cadadr polynom))
        (b (car (cdaddr polynom))))
    (cond ((and (not is_plus) is_power2) ;; разность квадратов
           `(* (- ,a ,b) (+ ,a ,b)))
          ((and is_plus (not is_power2)) ;; сумма кубов
           `(* (+ ,a ,b) (+ (expt ,a 2) (- (* ,a ,b)) (expt ,b 2))))
          ((and (not is_plus) (not is_power2)) ;; разность кубов
           `(* (- ,a ,b) (+ (expt ,a 2) (* ,a ,b) (expt ,b 2)))))))

;(display (factorize '(+ (expt a 3) (expt b 3))))
;(newline)
;(eval (list (list 'lambda '(x y) (factorize '(- (expt x 2) (expt y 2)))) 1 2) (interaction-environment))
```
